<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../../../04/28/RecSys-Overview/ rel=prev><link href=../../../../2025/01/08/Reddit%20AI%20Pulse%20%28On-Prem%29/ rel=next><link rel=icon href=../../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>RecSys Challenge 2024: Model Selection - SulmanK Blog</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.ab4e12ef.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../assets/_mkdocstrings.css><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../../../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#recsys-challenge-2024-model-selection class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../.. title="SulmanK Blog" class="md-header__button md-logo" aria-label="SulmanK Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SulmanK Blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> RecSys Challenge 2024: Model Selection </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/SulmanK/blog/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class=md-source__repository> blog </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../../ class=md-tabs__link> Writing </a> </li> <li class=md-tabs__item> <a href=../../../../../contact/ class=md-tabs__link> Contact </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../.. title="SulmanK Blog" class="md-nav__button md-logo" aria-label="SulmanK Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> SulmanK Blog </label> <div class=md-nav__source> <a href=https://github.com/SulmanK/blog/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class=md-source__repository> blog </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../ class="md-nav__link "> <span class=md-ellipsis> Writing </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Writing </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../archive/2026/ class=md-nav__link> <span class=md-ellipsis> 2026 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2025/ class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../category/ai/ class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/agent/ class=md-nav__link> <span class=md-ellipsis> Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/agentic-workflow/ class=md-nav__link> <span class=md-ellipsis> Agentic Workflow </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/agents/ class=md-nav__link> <span class=md-ellipsis> Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/benchmark/ class=md-nav__link> <span class=md-ellipsis> Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/cloud-architecture/ class=md-nav__link> <span class=md-ellipsis> Cloud Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/data-engineering/ class=md-nav__link> <span class=md-ellipsis> Data Engineering </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/data-science/ class=md-nav__link> <span class=md-ellipsis> Data Science </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/deep-learning-recommendation-models/ class=md-nav__link> <span class=md-ellipsis> Deep Learning Recommendation Models </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/evaluation/ class=md-nav__link> <span class=md-ellipsis> Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/exploratory-data-analysis/ class=md-nav__link> <span class=md-ellipsis> Exploratory Data Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/fastapi/ class=md-nav__link> <span class=md-ellipsis> FastAPI </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/full-stack/ class=md-nav__link> <span class=md-ellipsis> Full Stack </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/gcp/ class=md-nav__link> <span class=md-ellipsis> GCP </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/llm/ class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/llms/ class=md-nav__link> <span class=md-ellipsis> LLMs </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/ml/ class=md-nav__link> <span class=md-ellipsis> ML </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/machine-learning/ class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/model-selection/ class=md-nav__link> <span class=md-ellipsis> Model Selection </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/music-technology/ class=md-nav__link> <span class=md-ellipsis> Music Technology </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/react/ class=md-nav__link> <span class=md-ellipsis> React </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/recsys-challenge-2024/ class=md-nav__link> <span class=md-ellipsis> RecSys Challenge 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/recommendation-systems/ class=md-nav__link> <span class=md-ellipsis> Recommendation Systems </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/recommender-systems/ class=md-nav__link> <span class=md-ellipsis> Recommender Systems </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/social-deduction/ class=md-nav__link> <span class=md-ellipsis> Social Deduction </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/terraform/ class=md-nav__link> <span class=md-ellipsis> Terraform </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/web-development/ class=md-nav__link> <span class=md-ellipsis> Web Development </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/cloud/ class=md-nav__link> <span class=md-ellipsis> cloud </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/end-to-end-pipeline/ class=md-nav__link> <span class=md-ellipsis> end-to-end pipeline </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../../contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#news-recommendation class=md-nav__link> <span class=md-ellipsis> News Recommendation </span> </a> <nav class=md-nav aria-label="News Recommendation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#time-based-news-recommendation class=md-nav__link> <span class=md-ellipsis> Time-Based News Recommendation </span> </a> </li> <li class=md-nav__item> <a href=#location-based-news-recommendation class=md-nav__link> <span class=md-ellipsis> Location-Based News Recommendation </span> </a> </li> <li class=md-nav__item> <a href=#social-network-based-news-recommendation class=md-nav__link> <span class=md-ellipsis> Social Network-Based News Recommendation </span> </a> </li> <li class=md-nav__item> <a href=#sesssion-based-news-recommendation class=md-nav__link> <span class=md-ellipsis> Sesssion-Based News recommendation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#model-selection class=md-nav__link> <span class=md-ellipsis> Model Selection </span> </a> <nav class=md-nav aria-label="Model Selection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#content-based class=md-nav__link> <span class=md-ellipsis> Content Based </span> </a> <nav class=md-nav aria-label="Content Based"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tf-idf-vectorization class=md-nav__link> <span class=md-ellipsis> TF-IDF vectorization </span> </a> <nav class=md-nav aria-label="TF-IDF vectorization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cosine-similarity class=md-nav__link> <span class=md-ellipsis> Cosine Similarity </span> </a> </li> <li class=md-nav__item> <a href=#faiss class=md-nav__link> <span class=md-ellipsis> FAISS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hybrid-approach class=md-nav__link> <span class=md-ellipsis> Hybrid-Approach </span> </a> <nav class=md-nav aria-label=Hybrid-Approach> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deep-interest-network class=md-nav__link> <span class=md-ellipsis> Deep Interest Network </span> </a> <nav class=md-nav aria-label="Deep Interest Network"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-preparation class=md-nav__link> <span class=md-ellipsis> Data Preparation </span> </a> </li> <li class=md-nav__item> <a href=#model-training class=md-nav__link> <span class=md-ellipsis> Model training </span> </a> </li> <li class=md-nav__item> <a href=#prediction class=md-nav__link> <span class=md-ellipsis> Prediction </span> </a> </li> <li class=md-nav__item> <a href=#procedure class=md-nav__link> <span class=md-ellipsis> Procedure </span> </a> </li> <li class=md-nav__item> <a href=#results class=md-nav__link> <span class=md-ellipsis> Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deep-cross-network class=md-nav__link> <span class=md-ellipsis> Deep Cross Network </span> </a> <nav class=md-nav aria-label="Deep Cross Network"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-preparation_1 class=md-nav__link> <span class=md-ellipsis> Data Preparation </span> </a> </li> <li class=md-nav__item> <a href=#model-training_1 class=md-nav__link> <span class=md-ellipsis> Model training </span> </a> </li> <li class=md-nav__item> <a href=#prediction_1 class=md-nav__link> <span class=md-ellipsis> Prediction </span> </a> </li> <li class=md-nav__item> <a href=#procedure_1 class=md-nav__link> <span class=md-ellipsis> Procedure </span> </a> </li> <li class=md-nav__item> <a href=#results_1 class=md-nav__link> <span class=md-ellipsis> Results </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../../../../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src="https://avatars.githubusercontent.com/u/43801845?v=4" alt="Sulman Khan"> </span> <span class=md-profile__description> <strong> <a href=https://github.com/SulmanK>Sulman Khan</a> </strong> <br> Creator </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"></path></svg> <time datetime="2024-12-15 00:00:00+00:00" class=md-ellipsis>2024/12/15</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"></path></svg> <span class=md-ellipsis> in <a href=../../../../category/recsys-challenge-2024/ >RecSys Challenge 2024</a>, <a href=../../../../category/recommendation-systems/ >Recommendation Systems</a>, <a href=../../../../category/model-selection/ >Model Selection</a>, <a href=../../../../category/data-science/ >Data Science</a>, <a href=../../../../category/deep-learning-recommendation-models/ >Deep Learning Recommendation Models</a></span> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"></path></svg> <span class=md-ellipsis> 24 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <a href=https://github.com/SulmanK/blog/edit/master/docs/writing/posts/recsys_2024_modeling.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"></path></svg> </a> <a href=https://github.com/SulmanK/blog/raw/master/docs/writing/posts/recsys_2024_modeling.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"></path></svg> </a> <h1 id=recsys-challenge-2024-model-selection>RecSys Challenge 2024: Model Selection<a class=headerlink href=#recsys-challenge-2024-model-selection title="Permanent link">¶</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">¶</a></h2> <div class="admonition abstract"> <p class=admonition-title>Purpose</p> <p>This article will cover model selection in the RecSys Challenge 2024. The content will be structured into the following sections:</p> <ul> <li>News RecSys</li> <li>Model Selection</li> </ul> <p>For more in-depth analysis, please check out the <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/notebooks/2024_Recsys_Challenge_Model.ipynb>notebook</a>!</p> <!-- more --> </div> <div class="admonition info"> <p class=admonition-title>About</p> <p>This year's challenge focuses on online news recommendation, addressing both the technical and normative challenges inherent in designing effective and responsible recommender systems for news publishing. The challenge will delve into the unique aspects of news recommendation, including modeling user preferences based on implicit behavior, accounting for the influence of the news agenda on user interests, and managing the rapid decay of news items. Furthermore, our challenge embraces the normative complexities, involving investigating the effects of recommender systems on the news flow and whether they resonate with editorial values. <a href=https://recsys.eb.dk/ >[1]</a></p> </div> <div class="admonition info"> <p class=admonition-title>Challenge Task</p> <p>The Ekstra Bladet RecSys Challenge aims to predict which article a user will click on from a list of articles that were seen during a specific impression. Utilizing the user's click history, session details (like time and device used), and personal metadata (including gender and age), along with a list of candidate news articles listed in an impression log, the challenge's objective is to rank the candidate articles based on the user's personal preferences. This involves developing models that encapsulate both the users and the articles through their content and the users' interests. The models are to estimate the likelihood of a user clicking on each article by evaluating the compatibility between the article's content and the user's preferences. The articles are ranked based on these likelihood scores, and the precision of these rankings is measured against the actual selections made by users. <a href=https://recsys.eb.dk/ >[1]</a></p> </div> <div class="admonition info note"> <p class=admonition-title>Dataset Information</p> <p>The Ekstra Bladet News Recommendation Dataset (EB-NeRD) was created to support advancements in news recommendation research. It was collected from user behavior logs at Ekstra Bladet. We collected behavior logs from active users during the 6 weeks from April 27 to June 8, 2023. This timeframe was selected to avoid major events, e.g., holidays or elections, that could trigger atypical behavior at Ekstra Bladet. The active users were defined as users who had at least 5 and at most 1,000 news click records in a three-week period from May 18 to June 8, 2023. To protect user privacy, every user was delinked from the production system when securely hashed into an anonymized ID using one-time salt mapping. Alongside, we provide Danish news articles published by Ekstra Bladet. Each article is enriched with textual context features such as title, abstract, body, categories, among others. Furthermore, we provide features that have been generated by proprietary models, including topics, named entity recognition (NER), and article embeddings. <a href=https://recsys.eb.dk/dataset/ >[2]</a></p> <p>For more information on the <a href=https://recsys.eb.dk/dataset/ >dataset</a>.</p> </div> <h2 id=news-recommendation>News Recommendation<a class=headerlink href=#news-recommendation title="Permanent link">¶</a></h2> <div class="admonition question"> <p class=admonition-title>Why do we care about news recommendations?</p> </div> <p>With the rise of online news services like Google News, millions now access news conveniently online. However, finding relevant articles can be challenging. Personalized news recommender systems (NRS) address this by tailoring recommendations to individual interests, enhancing user experience and saving time. These systems track recent user interactions and incorporate factors like publication date, recency, and popularity into their algorithms.</p> <div class="admonition question"> <p class=admonition-title>What are important aspects of personalized news recommenders?</p> </div> <p>Unlike recommendation methods based solely on non-personalized factors like news popularity and freshness, personalized news recommendation (PNR) deeply considers each user's interests. It matches news content, location, and category to user preferences, offering personalized services. Key characteristics of PNR include:</p> <p>1) <strong>Diversity</strong>: High-quality recommendations require diverse results to enhance user experience and engagement. Most methods focus on accuracy, often neglecting diversity.</p> <p>2) <strong>Timeliness</strong>: Delivering news quickly is crucial, as the value of news diminishes over time.</p> <p>3) <strong>Popularity</strong>: Current methods predict click-through rates (CTR) using headlines, summaries, and entities, but few integrate news popularity and user attention to popular news in their predictions.</p> <div class="admonition question"> <p class=admonition-title>How can we solve this problem?</p> </div> <p>Understanding how predictions are made by standard news recommenders is often difficult due to unclear influencing factors. To address this, identifying the key factors that determine whether a user will click on an article is crucial. This approach offers several benefits:</p> <p>1) It helps system designers understand user behavior and improve recommendations.</p> <p>2) Transparent recommendations can increase user trust and acceptance.</p> <p>3) An explainable system enhances user experience, building overall trust.</p> <div class="admonition question"> <p class=admonition-title>What are area in which personalzied news recommendations fall under?</p> </div> <h3 id=time-based-news-recommendation>Time-Based News Recommendation<a class=headerlink href=#time-based-news-recommendation title="Permanent link">¶</a></h3> <p>Time-based news recommendation involves timeliness and real-time updates, crucial features that distinguish news recommendations from others. News loses value over time, so systems must update recommendations based on current user behavior (e.g., pulling and sliding). This ensures quick adaptation to changing interests and enhances the user experience.</p> <p>Liu et al. propose a dual-task deep neural network model that uses an extended time module to refine news embedding and predict user engagement time. This method improves the timeliness of recommendations and promotes the dissemination of the latest news. However, it can slightly diminish the focus on user interests, highlighting the need to balance timeliness and user preferences in news recommendation systems. <a href=https://www.ijcai.org/Proceedings/2020/482>[1]</a> </p> <h3 id=location-based-news-recommendation>Location-Based News Recommendation<a class=headerlink href=#location-based-news-recommendation title="Permanent link">¶</a></h3> <p>Mobile users' locations vary, making it essential to consider their current location for more accurate news recommendations. Location-based news recommendations help users find local news and stay updated on nearby events. However, research often focuses on improving location matching accuracy, neglecting location-aware user preferences.</p> <p>Yuan et al. address this by incorporating the location of news events into recommendation models. They propose an algorithm to extract news event locations and use a vector space model to represent news features. Separate user interest models are then constructed for news with and without geographical locations. <a href=https://www.jsjkx.com/EN/Y2018/V45/I11A/462>[2]</a></p> <h3 id=social-network-based-news-recommendation>Social Network-Based News Recommendation<a class=headerlink href=#social-network-based-news-recommendation title="Permanent link">¶</a></h3> <p>Social networks, composed of nodes (individuals) and edges (relationships), enable users to make friends and share information, significantly impacting information dissemination. Social information, reflecting users' and their friends' activities, captures the dynamic and diverse nature of user interests. Experiments show that incorporating social factors dynamically captures changing user interests, improving news recommendation effectiveness. </p> <p>Saravanapriya et al. propose a multilabel convolutional neural network that mines social media to predict users' multilabel interests and recommend popular news articles based on user tags. <a href=https://www.semanticscholar.org/paper/Multi-label-Convolution-Neural-Network-for-News-on-Saravanapriya-Senthilkumar/a6004a33699ced82c61ff2b492f225bdc44444d8>[3]</a></p> <h3 id=sesssion-based-news-recommendation>Sesssion-Based News recommendation<a class=headerlink href=#sesssion-based-news-recommendation title="Permanent link">¶</a></h3> <p>Session-based news recommendation models user preferences over short periods to provide personalized reading suggestions.</p> <p>Moreira et al. propose Chameleon, a session-based deep learning meta-architecture using recurrent neural networks (RNN) to model users' sequential interests. <a href=https://arxiv.org/pdf/1904.10367>[4]</a></p> <div class="admonition question"> <p class=admonition-title>How do traditional recommendaton system methods apply to news?</p> </div> <p>Traditional news recommendation methods fall into three categories: collaborative filtering-based, content-based, and hybrid methods.</p> <p>1) <strong>Collaborative filtering</strong>: Recommends news based on user similarities or news similarity. However, it often faces data sparsity and cold start issues due to insufficient user ratings, metadata, and textual content for new or less popular news.</p> <p>2) <strong>Content-based</strong>: Recommends news with similar content to the clicked news, focusing on mining semantic features of news texts.</p> <p>3) <strong>Hybrid</strong>: Combines collaborative filtering and content-based approaches to overcome limitations of individual methods.</p> <div class="admonition question"> <p class=admonition-title>Personalized News Recommender Workflow</p> </div> <p>In a personalized news recommender system, when a user visits the platform, a small set of candidate news is recalled from a large pool. The personalized recommender then ranks these based on inferred user interests from profiles. The top K news are displayed, and user behaviors on these are recorded to update user profiles for future recommendations. <a href=https://arxiv.org/abs/2106.08934>[5]</a></p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../../../img/pnr_diagram.png data-desc-position=bottom><img alt src=../../../../img/pnr_diagram.png></a></p> <p>There are three key components in this architecture that are crucial in providing accurate recommendations:</p> <p>1) News Modeling</p> <p>News modeling, crucial for news recommendation, employs two main techniques: feature-based and deep learning-based methods.</p> <p><strong>Feature-based</strong>: Relies on handcrafted features to represent news articles. For example, in collaborative filtering (CF), news articles are often represented by their IDs. However, this approach suffers from severe cold-start problems and suboptimal performance.</p> <p><strong>Deep learning-based</strong>: Incorporates content features to represent news, often using features extracted from news texts. For instance, methods like SF-IDF use WordNet synonym sets to enhance TF-IDF. Additionally, factors like news popularity and recency are considered. However, manually designing features requires significant effort and domain knowledge, and may not fully capture semantic information encoded in news texts.</p> <p>2) User Modeling</p> <p>User modeling techniques in news recommendation fall into two main categories: feature-based and deep learning-based methods.</p> <p><strong>Feature-based</strong>: Often represent users with their IDs but suffer from data sparsity issues. To improve accuracy, other user information such as click behaviors on news is considered. For instance, Garcin et al. use Latent Dirichlet Allocation (LDA) to extract topics from news titles, summaries, and bodies, aggregating topic vectors of clicked news into a user vector.</p> <p><strong>Deep learning-based</strong>: Utilize deep learning techniques to model user interests more accurately. These methods can automatically learn complex patterns from user interactions with news articles, potentially alleviating the need for manual feature engineering.</p> <p>3) Personalized Ranking</p> <p>Once news and user interests are modeled, the next step is to rank candidate news in a personalized manner. Methods typically prioritize news based on their relevance to user interests. Accurately measuring this relevance is the core challenge in personalized news ranking.</p> <div class="admonition question"> <p class=admonition-title>How do we evaluate these methods?</p> </div> <p>Various metrics evaluate news recommender system performance, focusing on ranking relevance. The Area Under Curve (AUC) score is commonly used, especially in methods treating recommendation as a classification problem.</p> <div class=arithmatex>\[ AUC = \frac{|\left((i,j)|Rank(p_i) &lt; Rank(n_j)\right)|}{N_pN_n}\]</div> <p><span class=arithmatex>\(N_p\)</span> and <span class=arithmatex>\(N_n\)</span> represent the numbers of positive and negative samples, respectively. <span class=arithmatex>\(p_i\)</span> is the predicted score of the <span class=arithmatex>\(i\)</span>-th positive sample, and <span class=arithmatex>\(n_j\)</span> is the score of the <span class=arithmatex>\(j\)</span>-th negative sample.</p> <p>Due to the large volume of news, users typically focus more on news at the top of the recommendation list. Some methods adjust recommendation results based on the ranking list. Common ranking evaluation metrics include MRR (mean reciprocal rank) and NDCG (normalized discounted cumulative gain).</p> <div class=arithmatex>\[MRR = \frac{1}{|U|}\sum_{u \in U}\frac{1}{rank_a}\]</div> <p>Here, <span class=arithmatex>\(u \in U\)</span> traverses all users, and <span class=arithmatex>\(rank_u\)</span> denotes the position of the first TP example in the user recommendation list.</p> <div class=arithmatex>\[ NDCG@K = \frac{\sum_{i = 1}^k (2^{r_i} - 1)/log_2(l+i)}{\sum_{u \in U} 1/log_2(l+i)}\]</div> <p>where <span class=arithmatex>\(r_i\)</span> is the relevance score of the <span class=arithmatex>\(i\)</span>-th news. If user clicks on the <span class=arithmatex>\(i\)</span>-th news, the value of <span class=arithmatex>\(r_i\)</span> is 1.</p> <h2 id=model-selection>Model Selection<a class=headerlink href=#model-selection title="Permanent link">¶</a></h2> <p>We will explore news recommendation systems, starting from first principles and progressing to state-of-the-art approaches. This will include exploring content-based approaches and hybrid-based approaches.</p> <h3 id=content-based>Content Based<a class=headerlink href=#content-based title="Permanent link">¶</a></h3> <p>Our first approach will be utilizing TF-IDF vectorization because of its simplicity.</p> <h4 id=tf-idf-vectorization>TF-IDF vectorization<a class=headerlink href=#tf-idf-vectorization title="Permanent link">¶</a></h4> <p>It stands for <strong>Term Frequency-Inverse Document Frequency</strong> and aims to quantify the importance of each word in a document relative to a collection of documents (the corpus). Words that appear frequently in a document but rarely in the rest of the corpus get high scores, making them important features. It has three major components:</p> <p>(1) <strong>Term Frequency (TF)</strong>: Measures how frequently a term occurs in a document.</p> <div class=arithmatex>\[ TF(t, d) = \frac{\text{Number of times term } t \text{ appears in document } d}{\text{Total number of terms in document } d}\]</div> <p>(2) <strong>Inverse Document Frequency (IDF)</strong>: Reduces the weight of terms that occur in many documents, as they are less informative.</p> <div class=arithmatex>\[ IDF(t) = \log\left(\frac{\text{Total number of documents}}{\text{Number of documents containing term } t}\right)\]</div> <p>(3) <strong>TF-IDF Score</strong>: Combines TF and IDF to assign a score to each term in a document.</p> <div class=arithmatex>\[ \text{TF-IDF}(t, d) = TF(t, d) \times IDF(t)\]</div> <p>Next, we need to use a similarity method to compare documents, such as cosine similarity or FAISS.</p> <h5 id=cosine-similarity>Cosine Similarity<a class=headerlink href=#cosine-similarity title="Permanent link">¶</a></h5> <p>Cosine similarity is a measure used to determine the similarity between two non-zero vectors in a multi-dimensional space. It calculates the cosine of the angle between the vectors, with values ranging from -1 to 1. In the context of NLP and recommender systems, it is commonly used to compare TF-IDF or word embeddings to evaluate the similarity between documents or items. Setting an appropriate threshold value is crucial for determining the significance of similarity. </p> <div class=arithmatex>\[ \text{cosine_similarity}(\mathbf{A}, \mathbf{B}) = \frac{\mathbf{A} \cdot \mathbf{B}}{\|\mathbf{A}\| \|\mathbf{B}\|}\]</div> <div class="admonition success"> <p class=admonition-title>Implmentation</p> </div> <p></p><div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Packages</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_extraction.text</span><span class=w> </span><span class=kn>import</span> <span class=n>TfidfVectorizer</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics.pairwise</span><span class=w> </span><span class=kn>import</span> <span class=n>cosine_similarity</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=kn>import</span><span class=w> </span><span class=nn>sklearn</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=c1># Load in training data</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=c1># Articles</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>df_art</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/articles.parquet"</span><span class=p>)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=c1># Behaviors</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>df_bev</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/train/behaviors.parquet"</span><span class=p>)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=c1># History</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=n>df_his</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/train/history.parquet"</span><span class=p>)</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=c1># Preprocess the data</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=c1># Convert datatype of column first</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=k>else</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>else</span> <span class=n>x</span><span class=p>)</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=c1># Join bevhaiors to article</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=n>df</span> <span class=o>=</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df_art</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s2>"article_id"</span><span class=p>),</span> <span class=n>on</span><span class=o>=</span><span class=s2>"article_id"</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=c1># Join bevhaiors to history</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df_his</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s2>"user_id"</span><span class=p>),</span> <span class=n>on</span><span class=o>=</span><span class=s2>"user_id"</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=c1># Drop all other dataframes from me</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=c1># Change article IDs into int</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=c1># Change age from int to string</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=n>df</span><span class=p>[</span><span class=s1>'device_type'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'device_type'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>device_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=c1># Change genders from float to string</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=n>df</span><span class=p>[</span><span class=s1>'gender'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'gender'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>gender_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=c1># Change age to str it's a range</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>'Int64'</span><span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a>    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=s1>'&lt;NA&gt;'</span> <span class=k>else</span> <span class=n>x</span> <span class=o>+</span> <span class=s1>' - '</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s1>'9'</span><span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=c1># Change postcodes from int to str</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=n>df</span><span class=p>[</span><span class=s1>'postcode'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'postcode'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>postcodes_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a><span class=c1># Modeling</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a><span class=c1># Rand Seed</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a><span class=c1># Merge fields into strings for processing</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'topics_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'topics'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'entity_groups_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'entity_groups'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'ner_clusters_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'ner_clusters'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a><span class=c1># Create a dictionary for quick lookups</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a><span class=n>article_content_dict</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a>    <span class=n>row</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]:</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'title'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'body'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'category_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'article_type'</span><span class=p>]</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a>                       <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'ner_clusters_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'entity_groups_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'topics_str'</span><span class=p>]</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>df_art</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a><span class=p>}</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a><span class=c1># Fit TF-IDF vectorizer</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a><span class=n>vectorizer</span> <span class=o>=</span> <span class=n>TfidfVectorizer</span><span class=p>(</span><span class=n>norm</span><span class=o>=</span><span class=s1>'l1'</span><span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a><span class=n>tfidf_matrix_all</span> <span class=o>=</span> <span class=n>vectorizer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>article_content_dict</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a><span class=n>article_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>article_content_dict</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a><span class=c1># Map article IDs to indices in the TF-IDF matrix</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a><span class=n>article_id_to_idx</span> <span class=o>=</span> <span class=p>{</span><span class=n>article_id</span><span class=p>:</span> <span class=n>idx</span> <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>article_id</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>article_ids</span><span class=p>)}</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a><span class=c1># Initialize predicted impressions list</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a><span class=n>predicted_impressions</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a><span class=c1># Store similarity scores for auc_score</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a><span class=n>similarity_scores</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a><span class=c1># Process each row of the user behavior data</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>1000</span><span class=p>]:</span>  
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a>    <span class=c1># Extract the articles viewed by the current user</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a>    <span class=n>user_article_history</span> <span class=o>=</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=s1>'article_ids_inview'</span><span class=p>]</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a>    <span class=c1># Map article IDs to indices if they exist in the article ID-to-index dictionary</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a>    <span class=n>indices</span> <span class=o>=</span> <span class=p>[</span><span class=n>article_id_to_idx</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>user_article_history</span> <span class=k>if</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>article_id_to_idx</span><span class=p>]</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a>    <span class=c1># If no valid indices are found, append None to predictions and skip further processing</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>indices</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a>        <span class=k>continue</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a>    <span class=c1># Compute the average TF-IDF vector for the user's article history</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94 href=#__codelineno-0-94></a>    <span class=n>user_profile_vector</span> <span class=o>=</span> <span class=n>tfidf_matrix_all</span><span class=p>[</span><span class=n>indices</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>A</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95 href=#__codelineno-0-95></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96 href=#__codelineno-0-96></a>    <span class=n>highest_similarity</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97 href=#__codelineno-0-97></a>    <span class=n>best_imp</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98 href=#__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99 href=#__codelineno-0-99></a>    <span class=c1># Evaluate each article in the user's history for similarity to the user's profile</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100 href=#__codelineno-0-100></a>    <span class=k>for</span> <span class=n>imp</span> <span class=ow>in</span> <span class=n>user_article_history</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101 href=#__codelineno-0-101></a>        <span class=k>if</span> <span class=n>imp</span> <span class=ow>in</span> <span class=n>article_id_to_idx</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102 href=#__codelineno-0-102></a>            <span class=c1># Retrieve the TF-IDF vector for the article</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103 href=#__codelineno-0-103></a>            <span class=n>imp_idx</span> <span class=o>=</span> <span class=n>article_id_to_idx</span><span class=p>[</span><span class=n>imp</span><span class=p>]</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104 href=#__codelineno-0-104></a>            <span class=n>imp_tfidf_vector</span> <span class=o>=</span> <span class=n>tfidf_matrix_all</span><span class=p>[</span><span class=n>imp_idx</span><span class=p>]</span><span class=o>.</span><span class=n>A</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105 href=#__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106 href=#__codelineno-0-106></a>            <span class=c1># Calculate the cosine similarity between the user's profile and the article</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107 href=#__codelineno-0-107></a>            <span class=n>similarity</span> <span class=o>=</span> <span class=n>cosine_similarity</span><span class=p>(</span><span class=n>user_profile_vector</span><span class=p>,</span> <span class=n>imp_tfidf_vector</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>))[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108 href=#__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109 href=#__codelineno-0-109></a>            <span class=c1># Update the best match if the current similarity is higher</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110 href=#__codelineno-0-110></a>            <span class=k>if</span> <span class=n>similarity</span> <span class=o>&gt;</span> <span class=n>highest_similarity</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111 href=#__codelineno-0-111></a>                <span class=n>highest_similarity</span> <span class=o>=</span> <span class=n>similarity</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112 href=#__codelineno-0-112></a>                <span class=n>best_imp</span> <span class=o>=</span> <span class=n>imp</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113 href=#__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114 href=#__codelineno-0-114></a>    <span class=c1># If similarity is low, pick a random article; otherwise, use the best match</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115 href=#__codelineno-0-115></a>    <span class=k>if</span> <span class=n>highest_similarity</span> <span class=o>&lt;=</span> <span class=mf>0.5</span><span class=p>:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116 href=#__codelineno-0-116></a>        <span class=n>impression</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>user_article_history</span><span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117 href=#__codelineno-0-117></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>impression</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118 href=#__codelineno-0-118></a>        <span class=c1># Assign low similarity value for random choice</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119 href=#__codelineno-0-119></a>        <span class=n>similarity_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>  
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120 href=#__codelineno-0-120></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"User </span><span class=si>{</span><span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=s1>'user_id'</span><span class=p>]</span><span class=si>}</span><span class=s2>: Low similarity, random impression chosen"</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121 href=#__codelineno-0-121></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122 href=#__codelineno-0-122></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>best_imp</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123 href=#__codelineno-0-123></a>        <span class=n>similarity_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>highest_similarity</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124 href=#__codelineno-0-124></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"User </span><span class=si>{</span><span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=s1>'user_id'</span><span class=p>]</span><span class=si>}</span><span class=s2>: Best impression </span><span class=si>{</span><span class=n>best_imp</span><span class=si>}</span><span class=s2> with similarity </span><span class=si>{</span><span class=n>highest_similarity</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125 href=#__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126 href=#__codelineno-0-126></a><span class=c1># Prepare binary labels for AUC</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127 href=#__codelineno-0-127></a><span class=n>actual_impressions</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_ids_clicked'</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>][</span><span class=mi>0</span><span class=p>:</span><span class=mi>1000</span><span class=p>]</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128 href=#__codelineno-0-128></a><span class=n>binary_labels</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=k>if</span> <span class=n>pred</span> <span class=o>==</span> <span class=n>actual</span> <span class=k>else</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>pred</span><span class=p>,</span> <span class=n>actual</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>predicted_impressions</span><span class=p>,</span> <span class=n>actual_impressions</span><span class=p>)]</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129 href=#__codelineno-0-129></a><span class=n>auc_score</span> <span class=o>=</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>binary_labels</span><span class=p>,</span> <span class=n>similarity_scores</span><span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130 href=#__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131 href=#__codelineno-0-131></a><span class=c1># Calculate accuracy</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132 href=#__codelineno-0-132></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>predicted_impressions</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133 href=#__codelineno-0-133></a><span class=n>y_true</span> <span class=o>=</span> <span class=n>actual_impressions</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134 href=#__codelineno-0-134></a><span class=n>acc</span> <span class=o>=</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135 href=#__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136 href=#__codelineno-0-136></a><span class=nb>print</span><span class=p>(</span><span class=s2>"-------------------------"</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137 href=#__codelineno-0-137></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Accuracy:"</span><span class=p>,</span> <span class=n>acc</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138 href=#__codelineno-0-138></a><span class=nb>print</span><span class=p>(</span><span class=s2>"AUC Score:"</span><span class=p>,</span> <span class=n>auc_score</span><span class=p>)</span>
</span></code></pre></div> The model's accuracy is 0.12, lower than a random model's 1/6 (≈0.1667) chance. However, its ROC-AUC score is 0.59, indicating a decent starting point as it outperforms random guessing.<p></p> <h5 id=faiss>FAISS<a class=headerlink href=#faiss title="Permanent link">¶</a></h5> <p>FAISS (Facebook AI Similarity Search) is a library developed by Facebook AI that provides efficient tools for similarity search and clustering of dense vectors. The central task in FAISS is finding vectors in a database that are closest to a query vector, typically using a similarity measure like cosine similarity or Euclidean distance. Setting an appropriate threshold value is crucial for determining the significance of similarity. In some cases, a dimensional reduction techniques such as SVD must be employed to lower the number of memory required for computation.</p> <div class="admonition success"> <p class=admonition-title>Implmentation</p> </div> <p></p><div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Packages</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>TruncatedSVD</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_extraction.text</span><span class=w> </span><span class=kn>import</span> <span class=n>TfidfVectorizer</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=kn>import</span><span class=w> </span><span class=nn>sklearn</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=kn>import</span><span class=w> </span><span class=nn>faiss</span>  
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=c1># Load in training data</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=c1># Articles</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>df_art</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/articles.parquet"</span><span class=p>)</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=c1># Behaviors</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=n>df_bev</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/train/behaviors.parquet"</span><span class=p>)</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=c1># History</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=n>df_his</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>"Data/Small/train/history.parquet"</span><span class=p>)</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=c1># Preprocess the data</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=c1># Convert datatype of column first</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=k>else</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>else</span> <span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=c1># Join bevhaiors to article</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=n>df</span> <span class=o>=</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df_art</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s2>"article_id"</span><span class=p>),</span> <span class=n>on</span><span class=o>=</span><span class=s2>"article_id"</span><span class=p>)</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=c1># Join bevhaiors to history</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df_his</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s2>"user_id"</span><span class=p>),</span> <span class=n>on</span><span class=o>=</span><span class=s2>"user_id"</span><span class=p>)</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=c1># Drop all other dataframes from me</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=c1># Change article IDs into int</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=c1># Change age from int to string</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=n>df</span><span class=p>[</span><span class=s1>'device_type'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'device_type'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>device_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=c1># Change genders from float to string</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=n>df</span><span class=p>[</span><span class=s1>'gender'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'gender'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>gender_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=c1># Change age to str it's a range</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>'Int64'</span><span class=p>)</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'age'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=s1>'&lt;NA&gt;'</span> <span class=k>else</span> <span class=n>x</span> <span class=o>+</span> <span class=s1>' - '</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s1>'9'</span><span class=p>)</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=c1># Change postcodes from int to str</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=n>df</span><span class=p>[</span><span class=s1>'postcode'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'postcode'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>postcodes_</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=c1># Modeling</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=c1># Rand Seed</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=c1># Merge fields into strings for processing</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'topics_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'topics'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'entity_groups_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'entity_groups'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a><span class=n>df_art</span><span class=p>[</span><span class=s1>'ner_clusters_str'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_art</span><span class=p>[</span><span class=s1>'ner_clusters'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=s1>' '</span><span class=o>.</span><span class=n>join</span><span class=p>)</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a><span class=c1># Create a dictionary for quick lookups</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a><span class=n>article_content_dict</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a>    <span class=n>row</span><span class=p>[</span><span class=s1>'article_id'</span><span class=p>]:</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'title'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'body'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'category_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'article_type'</span><span class=p>]</span><span class=si>}</span><span class=s2> "</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>                       <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'ner_clusters_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'entity_groups_str'</span><span class=p>]</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>'topics_str'</span><span class=p>]</span><span class=si>}</span><span class=s2>"</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>df_art</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a><span class=p>}</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a><span class=c1># Fit TF-IDF vectorizer</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a><span class=n>vectorizer</span> <span class=o>=</span> <span class=n>TfidfVectorizer</span><span class=p>(</span><span class=n>norm</span><span class=o>=</span><span class=s1>'l1'</span><span class=p>)</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a><span class=n>tfidf_matrix_all</span> <span class=o>=</span> <span class=n>vectorizer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>article_content_dict</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a><span class=n>article_ids</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>article_content_dict</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a><span class=c1># Dimensionality reduction for the TF-IDF matrix</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a><span class=c1># Number of components to keep</span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a><span class=n>n_components</span> <span class=o>=</span> <span class=mi>100</span>  
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a><span class=n>svd</span> <span class=o>=</span> <span class=n>TruncatedSVD</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=n>n_components</span><span class=p>)</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a><span class=n>tfidf_matrix_reduced</span> <span class=o>=</span> <span class=n>svd</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>tfidf_matrix_all</span><span class=p>)</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a><span class=c1># Create a FAISS index for the reduced TF-IDF matrix</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=n>index</span> <span class=o>=</span> <span class=n>faiss</span><span class=o>.</span><span class=n>IndexFlatL2</span><span class=p>(</span><span class=n>tfidf_matrix_reduced</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> 
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a><span class=n>index</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>tfidf_matrix_reduced</span><span class=p>)</span>  
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=c1># Map article IDs to indices in the TF-IDF matrix</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=n>article_id_to_idx</span> <span class=o>=</span> <span class=p>{</span><span class=n>article_id</span><span class=p>:</span> <span class=n>idx</span> <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>article_id</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>article_ids</span><span class=p>)}</span>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a><span class=c1># Initialize predicted impressions list</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a><span class=n>predicted_impressions</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=c1># Store similarity scores for auc_score</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=n>similarity_scores</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=c1># Process each user behavior</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>1000</span><span class=p>]:</span>
</span><span id=__span-1-93><a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a>    <span class=n>user_article_history</span> <span class=o>=</span> <span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=s1>'article_ids_inview'</span><span class=p>]</span>
</span><span id=__span-1-94><a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a>    <span class=n>indices</span> <span class=o>=</span> <span class=p>[</span><span class=n>article_id_to_idx</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>user_article_history</span> <span class=k>if</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>article_id_to_idx</span><span class=p>]</span>
</span><span id=__span-1-95><a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a>
</span><span id=__span-1-96><a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>indices</span><span class=p>:</span>
</span><span id=__span-1-97><a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-1-98><a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a>        <span class=k>continue</span>
</span><span id=__span-1-99><a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a>
</span><span id=__span-1-100><a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a>    <span class=c1># Aggregate user history into a single vector</span>
</span><span id=__span-1-101><a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a>    <span class=n>user_profile_vector</span> <span class=o>=</span> <span class=n>tfidf_matrix_reduced</span><span class=p>[</span><span class=n>indices</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span><span id=__span-1-102><a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a>
</span><span id=__span-1-103><a id=__codelineno-1-103 name=__codelineno-1-103 href=#__codelineno-1-103></a>    <span class=c1># Use FAISS to find nearest neighbors (articles) based on user profile vector</span>
</span><span id=__span-1-104><a id=__codelineno-1-104 name=__codelineno-1-104 href=#__codelineno-1-104></a>    <span class=c1># Search for top 10 nearest neighbors (articles)</span>
</span><span id=__span-1-105><a id=__codelineno-1-105 name=__codelineno-1-105 href=#__codelineno-1-105></a>    <span class=n>D</span><span class=p>,</span> <span class=n>I</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>user_profile_vector</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-1-106><a id=__codelineno-1-106 name=__codelineno-1-106 href=#__codelineno-1-106></a>
</span><span id=__span-1-107><a id=__codelineno-1-107 name=__codelineno-1-107 href=#__codelineno-1-107></a>    <span class=c1># Get the most similar article based on the nearest neighbor</span>
</span><span id=__span-1-108><a id=__codelineno-1-108 name=__codelineno-1-108 href=#__codelineno-1-108></a>    <span class=n>highest_similarity</span> <span class=o>=</span> <span class=n>D</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-1-109><a id=__codelineno-1-109 name=__codelineno-1-109 href=#__codelineno-1-109></a>    <span class=n>best_imp_idx</span> <span class=o>=</span> <span class=n>I</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-1-110><a id=__codelineno-1-110 name=__codelineno-1-110 href=#__codelineno-1-110></a>
</span><span id=__span-1-111><a id=__codelineno-1-111 name=__codelineno-1-111 href=#__codelineno-1-111></a>    <span class=c1># Handle low similarity by selecting a random article</span>
</span><span id=__span-1-112><a id=__codelineno-1-112 name=__codelineno-1-112 href=#__codelineno-1-112></a>    <span class=k>if</span> <span class=n>highest_similarity</span> <span class=o>&lt;</span> <span class=mf>0.00005</span><span class=p>:</span>
</span><span id=__span-1-113><a id=__codelineno-1-113 name=__codelineno-1-113 href=#__codelineno-1-113></a>        <span class=n>impression</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>user_article_history</span><span class=p>)</span>
</span><span id=__span-1-114><a id=__codelineno-1-114 name=__codelineno-1-114 href=#__codelineno-1-114></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>impression</span><span class=p>)</span>
</span><span id=__span-1-115><a id=__codelineno-1-115 name=__codelineno-1-115 href=#__codelineno-1-115></a>        <span class=n>similarity_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-1-116><a id=__codelineno-1-116 name=__codelineno-1-116 href=#__codelineno-1-116></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"User </span><span class=si>{</span><span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=s1>'user_id'</span><span class=p>]</span><span class=si>}</span><span class=s2>: Low similarity, random impression chosen"</span><span class=p>)</span>
</span><span id=__span-1-117><a id=__codelineno-1-117 name=__codelineno-1-117 href=#__codelineno-1-117></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-1-118><a id=__codelineno-1-118 name=__codelineno-1-118 href=#__codelineno-1-118></a>        <span class=c1># Retrieve the article ID of the best match</span>
</span><span id=__span-1-119><a id=__codelineno-1-119 name=__codelineno-1-119 href=#__codelineno-1-119></a>        <span class=n>best_imp</span> <span class=o>=</span> <span class=n>article_ids</span><span class=p>[</span><span class=n>best_imp_idx</span><span class=p>]</span>
</span><span id=__span-1-120><a id=__codelineno-1-120 name=__codelineno-1-120 href=#__codelineno-1-120></a>        <span class=n>predicted_impressions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>best_imp</span><span class=p>)</span>
</span><span id=__span-1-121><a id=__codelineno-1-121 name=__codelineno-1-121 href=#__codelineno-1-121></a>        <span class=c1># Store the similarity score</span>
</span><span id=__span-1-122><a id=__codelineno-1-122 name=__codelineno-1-122 href=#__codelineno-1-122></a>        <span class=n>similarity_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>highest_similarity</span><span class=p>)</span>  
</span><span id=__span-1-123><a id=__codelineno-1-123 name=__codelineno-1-123 href=#__codelineno-1-123></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"User </span><span class=si>{</span><span class=n>df_bev</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=s1>'user_id'</span><span class=p>]</span><span class=si>}</span><span class=s2>: Best impression </span><span class=si>{</span><span class=n>best_imp</span><span class=si>}</span><span class=s2> with similarity </span><span class=si>{</span><span class=n>highest_similarity</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-1-124><a id=__codelineno-1-124 name=__codelineno-1-124 href=#__codelineno-1-124></a>
</span><span id=__span-1-125><a id=__codelineno-1-125 name=__codelineno-1-125 href=#__codelineno-1-125></a><span class=c1># Prepare binary labels for AUC</span>
</span><span id=__span-1-126><a id=__codelineno-1-126 name=__codelineno-1-126 href=#__codelineno-1-126></a><span class=n>actual_impressions</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>df_bev</span><span class=p>[</span><span class=s1>'article_ids_clicked'</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>][</span><span class=mi>0</span><span class=p>:</span><span class=mi>1000</span><span class=p>]</span>
</span><span id=__span-1-127><a id=__codelineno-1-127 name=__codelineno-1-127 href=#__codelineno-1-127></a><span class=n>binary_labels</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=k>if</span> <span class=n>pred</span> <span class=o>==</span> <span class=n>actual</span> <span class=k>else</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>pred</span><span class=p>,</span> <span class=n>actual</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>predicted_impressions</span><span class=p>,</span> <span class=n>actual_impressions</span><span class=p>)]</span>
</span><span id=__span-1-128><a id=__codelineno-1-128 name=__codelineno-1-128 href=#__codelineno-1-128></a><span class=n>auc_score</span> <span class=o>=</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>binary_labels</span><span class=p>,</span> <span class=n>similarity_scores</span><span class=p>)</span>
</span><span id=__span-1-129><a id=__codelineno-1-129 name=__codelineno-1-129 href=#__codelineno-1-129></a>
</span><span id=__span-1-130><a id=__codelineno-1-130 name=__codelineno-1-130 href=#__codelineno-1-130></a><span class=c1># Calculate accuracy</span>
</span><span id=__span-1-131><a id=__codelineno-1-131 name=__codelineno-1-131 href=#__codelineno-1-131></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>predicted_impressions</span>
</span><span id=__span-1-132><a id=__codelineno-1-132 name=__codelineno-1-132 href=#__codelineno-1-132></a><span class=n>y_true</span> <span class=o>=</span> <span class=n>actual_impressions</span>
</span><span id=__span-1-133><a id=__codelineno-1-133 name=__codelineno-1-133 href=#__codelineno-1-133></a><span class=n>acc</span> <span class=o>=</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-1-134><a id=__codelineno-1-134 name=__codelineno-1-134 href=#__codelineno-1-134></a>
</span><span id=__span-1-135><a id=__codelineno-1-135 name=__codelineno-1-135 href=#__codelineno-1-135></a><span class=nb>print</span><span class=p>(</span><span class=s2>"-------------------------"</span><span class=p>)</span>
</span><span id=__span-1-136><a id=__codelineno-1-136 name=__codelineno-1-136 href=#__codelineno-1-136></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Accuracy:"</span><span class=p>,</span> <span class=n>acc</span><span class=p>)</span>
</span><span id=__span-1-137><a id=__codelineno-1-137 name=__codelineno-1-137 href=#__codelineno-1-137></a><span class=nb>print</span><span class=p>(</span><span class=s2>"AUC Score:"</span><span class=p>,</span> <span class=n>auc_score</span><span class=p>)</span>
</span></code></pre></div> The model's accuracy is 0.096, below a random model's 1/6 (≈0.1667) chance, and its ROC-AUC score of 0.3324 indicates it performs worse than random guessing.<p></p> <h3 id=hybrid-approach>Hybrid-Approach<a class=headerlink href=#hybrid-approach title="Permanent link">¶</a></h3> <p>Content-based approaches performed poorly due to the use of TF-IDF vectorization, a bag-of-words model that fails to capture relationships between words. Now, we'll use more state-of-the-art models!</p> <div class="admonition question"> <p class=admonition-title>What are some hybrid-based CTR approaches that can be applied to news recommendation?</p> </div> <p>While researching novel recommender systems for CTR prediction, I discovered the BARS-CTR paper, which offers an open-source benchmark across diverse datasets and models. Its GitHub repository, <a href=https://github.com/reczoo/FuxiCTR>FuxiCTR</a>, was pivotal in understanding and applying hybrid approaches like Deep &amp; Cross Network (DCN) and Deep Interest Network (DIN). <a href=https://arxiv.org/pdf/2009.05794>[6]</a></p> <h4 id=deep-interest-network>Deep Interest Network<a class=headerlink href=#deep-interest-network title="Permanent link">¶</a></h4> <p>The Deep Interest Network (DIN) enhances CTR prediction by adaptively capturing users' diverse interests. It uses a local activation unit to model user behaviors in relation to the specific ad, improving on traditional Embedding &amp; MLP methods.</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../../../img/din_architecture.png data-desc-position=bottom><img alt src=../../../../img/din_architecture.png></a></p> <p>The local activation unit in DIN is a key component that allows the model to capture the diversity of user interests by dynamically generating a user representation vector based on the relevance of their past behaviors to the specific ad being shown. Instead of a fixed representation, this unit emphasizes behaviors related to the ad being considered. For example, if a user has browsed both clothes and electronics, the local activation unit will give more weight to clothes-related behaviors when predicting their likelihood to click on a T-shirt ad. This weighted sum pooling approach, similar to attention mechanisms but without normalizing the weights, retains information about the intensity of the user's interest, allowing DIN to distinguish between strong and weak interest levels. <a href=https://arxiv.org/pdf/1706.06978>[7]</a></p> <h5 id=data-preparation>Data Preparation<a class=headerlink href=#data-preparation title="Permanent link">¶</a></h5> <p>The data preparation script is displayed <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/data/prepare_data_v1.py>here</a>.</p> <p>The main goal is to preprocess news and user interaction data across the training, validation, and testing sets.</p> <ul> <li>Inputs: article, behavior, history .parquet files</li> <li>Output: training, validation, testing .csv files</li> </ul> <p><strong>Function</strong></p> <ol> <li> <p>Loading in news articles from the parquet files.</p> </li> <li> <p>Tokenize and map categorical features.</p> </li> <li> <p>Process user interaction history.</p> </li> <li> <p>Create feature mappings for categories, sentiments, and article types.</p> </li> <li> <p>Generate CSV files with processed features.</p> </li> </ol> <h5 id=model-training>Model training<a class=headerlink href=#model-training title="Permanent link">¶</a></h5> <p>Train a Deep Interest Network (DIN) model. The model configuration is <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/config/base_config/model_config.yaml>here</a>. </p> <p><strong>Important parameters</strong></p> <p><em>Model Architecture</em></p> <ul> <li>embedding_dim: Dimensionality of feature embeddings (default: 40)</li> <li>dnn_hidden_units: Neural network architecture (default: [500, 500, 500])</li> <li>dnn_activations: Activation function for dense layers (default: relu)</li> </ul> <p><em>Attention Mechanism</em></p> <ul> <li>din_target_field: The target item being predicted</li> <li>din_sequence_field: User's historical interaction sequence</li> <li>attention_hidden_units: Structure of attention network</li> <li>attention_hidden_activations: Activation in attention layers (default: "Dice")</li> <li>din_use_softmax: Whether to use softmax in attention mechanism</li> </ul> <p><em>Training Dynamics</em></p> <ul> <li>learning_rate: Controls model convergence (default: 1e-3)</li> <li>batch_size: Number of samples per training iteration</li> <li>epochs: Total training iterations</li> <li>optimizer: Optimization algorithm (default: adam)</li> </ul> <p>Below is a code snippet of a DIN dataset config that performed the best. </p><div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>dataset_config</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=n>ebnerd_large_x2</span><span class=p>:</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>        <span class=n>data_root</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>        <span class=n>data_format</span><span class=p>:</span> <span class=n>csv</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>        <span class=n>train_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>train</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>        <span class=n>valid_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>valid</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>        <span class=n>test_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>//</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>test</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>        <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>10</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>        <span class=n>data_block_size</span><span class=p>:</span> <span class=mi>100000</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>        <span class=n>streaming</span><span class=p>:</span> <span class=kc>True</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>        <span class=n>feature_cols</span><span class=p>:</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>meta</span><span class=p>,</span> <span class=n>remap</span><span class=p>:</span> <span class=kc>False</span><span class=p>}</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>read_time</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>trigger_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>device_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>is_sso_user</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>gender</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>postcode</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>age</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>is_subscriber</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>premium</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>ner_clusters</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>topics</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>category</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>subcategory</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_inviews</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_pageviews</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_read_time</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>sentiment_score</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>sentiment_label</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>subcat1</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id</span><span class=p>}</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_cat</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>category</span><span class=p>}</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_subcat1</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>subcat1</span><span class=p>}</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_sentiment</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>sentiment_label</span><span class=p>}</span>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_type</span><span class=p>}</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>publish_days</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>publish_hours</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_hour</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_weekday</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>pulish_3day</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>pulish_7day</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id_img</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(article_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/image_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-2-48><a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-2-49><a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id_text</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-2-50><a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(article_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/contrast_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-2-51><a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-2-52><a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id_img</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-2-53><a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(hist_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/image_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-2-54><a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id_img</span><span class=p>}</span>
</span><span id=__span-2-55><a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id_text</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-2-56><a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(hist_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/contrast_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-2-57><a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id_text</span><span class=p>}</span>     
</span><span id=__span-2-58><a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a>        <span class=n>label_col</span><span class=p>:</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>click</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>}</span>
</span></code></pre></div><p></p> <p>Below is a code snippet of a DIN model config that performed the best. </p><div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>DIN_doubleq</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>attention_dropout</span><span class=p>:</span> <span class=mf>0.2</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    <span class=n>attention_hidden_activations</span><span class=p>:</span> <span class=n>ReLU</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=n>attention_hidden_units</span><span class=p>:</span> <span class=p>[</span><span class=mi>512</span><span class=p>,</span> <span class=mi>256</span><span class=p>]</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=n>attention_output_activation</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>    <span class=n>batch_norm</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=mi>7168</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>    <span class=n>dataset_id</span><span class=p>:</span> <span class=n>TBD</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>    <span class=n>debug_mode</span><span class=p>:</span> <span class=n>false</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>    <span class=n>din_sequence_field</span><span class=p>:</span> <span class=n>click_history</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=n>din_target_field</span><span class=p>:</span> <span class=n>item_id</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>    <span class=n>din_use_softmax</span><span class=p>:</span> <span class=n>false</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    <span class=n>dnn_activations</span><span class=p>:</span> <span class=n>ReLU</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=n>dnn_hidden_units</span><span class=p>:</span> <span class=p>[</span><span class=mi>1024</span><span class=p>,</span> <span class=mi>512</span><span class=p>,</span> <span class=mi>256</span><span class=p>]</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>    <span class=n>early_stop_patience</span><span class=p>:</span> <span class=mi>2</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>    <span class=n>embedding_dim</span><span class=p>:</span> <span class=mi>64</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>    <span class=n>embedding_regularizer</span><span class=p>:</span> <span class=mf>0.0001</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>    <span class=n>epochs</span><span class=p>:</span> <span class=mi>10</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>    <span class=n>eval_steps</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>    <span class=n>feature_config</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>    <span class=n>feature_specs</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>    <span class=n>group_id</span><span class=p>:</span> <span class=n>impression_id</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>    <span class=n>item_info_fields</span><span class=p>:</span> <span class=mi>12</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>    <span class=n>learning_rate</span><span class=p>:</span> <span class=mf>0.0005</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>    <span class=n>loss</span><span class=p>:</span> <span class=n>binary_crossentropy</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>    <span class=n>metrics</span><span class=p>:</span> <span class=p>[</span><span class=n>avgAUC</span><span class=p>,</span> <span class=n>AUC</span><span class=p>,</span> <span class=n>logloss</span><span class=p>]</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>    <span class=n>model</span><span class=p>:</span> <span class=n>DIN</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>    <span class=n>model_root</span><span class=p>:</span> <span class=o>./</span><span class=n>checkpoints</span><span class=o>/</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>    <span class=n>monitor</span><span class=p>:</span> <span class=n>avgAUC</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>    <span class=n>monitor_mode</span><span class=p>:</span> <span class=nb>max</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>    <span class=n>net_dropout</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>    <span class=n>net_regularizer</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>    <span class=n>num_workers</span><span class=p>:</span> <span class=mi>3</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a>    <span class=n>optimizer</span><span class=p>:</span> <span class=n>adam</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>    <span class=n>pickle_feature_encoder</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>    <span class=n>save_best_only</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>    <span class=n>seed</span><span class=p>:</span> <span class=mi>20242025</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>    <span class=n>shuffle</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>    <span class=n>task</span><span class=p>:</span> <span class=n>binary_classification</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>    <span class=n>use_features</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a>    <span class=n>verbose</span><span class=p>:</span> <span class=mi>1</span>
</span></code></pre></div><p></p> <h5 id=prediction>Prediction<a class=headerlink href=#prediction title="Permanent link">¶</a></h5> <p>The submission script is displayed <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/submit.py>here</a>.</p> <p>The main goal is to make predictions on the testing set.</p> <p><strong>Function</strong></p> <ol> <li>Create a data loader for test data</li> <li>Load test data from CSV</li> <li>Predicts scores for each sample</li> <li>Ranks predictions for each impression </li> <li>Writes results to a predictions.txt file</li> <li>Zip the predictions </li> </ol> <h5 id=procedure>Procedure<a class=headerlink href=#procedure title="Permanent link">¶</a></h5> <ol> <li> <p>Prepare the data by preprocessing news and user interaction data. (go to fuxcitr_dir/data directory)</p> <p><code>python prepare_data_v2.py</code></p> </li> <li> <p>Run the following script in the fuxcitr_dir directory to train the model on train and validation sets.</p> <p><code>python run_param_tuner.py --config config/DIN_ebnerd_large_x2_tuner_config_doubleq_02.yaml --gpu 0</code></p> </li> <li> <p>Run the following script in the fuxcitr_dir directory to make predictions on the test set.</p> <p><code>python submit.py --config config/DIN_ebnerd_large_x2_tuner_config_doubleq_02 --expid DIN_ebnerd_large_x2_001_1860e41e --gpu 1</code></p> </li> </ol> <h5 id=results>Results<a class=headerlink href=#results title="Permanent link">¶</a></h5> <p>The results of our best-performing run, including detailed metrics, can be found <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/exp_results/DiN_ebnerd_large_x2_tuner_config_doubleq_02.csv>here</a>. It outlines the specifications of our top DIN model, in which we achieved an ROC-AUC score of 0.676359.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a> 20241214-233112,[command] python run_expid.py --config config/DiN_ebnerd_large_x2_tuner_config_doubleq_02 --expid DIN_ebnerd_large_x2_001_3e89b3ec --gpu 0,[exp_id] DIN_ebnerd_large_x2_001_3e89b3ec,[dataset_id] ebnerd_large_x2_7ea969aa,[train] N.A.,[val] avgAUC: 0.676359 - MRR: 0.443784 - NDCG(k=5): 0.504221,[test] 
</span></code></pre></div> <h4 id=deep-cross-network>Deep Cross Network<a class=headerlink href=#deep-cross-network title="Permanent link">¶</a></h4> <p>The Deep Cross Network (DCN) combines a cross network and a deep neural network to capture feature interactions in high-dimensional sparse data. The cross network handles explicit feature crossing, while the deep network models implicit interactions. <a href=https://arxiv.org/pdf/1708.05123>[8]</a></p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../../../../img/dcn_architecture.png data-desc-position=bottom><img alt src=../../../../img/dcn_architecture.png></a></p> <p>Here's a simplified breakdown of its components:</p> <ol> <li> <p><strong>Embedding and Stacking Layer</strong></p> <ul> <li>Converts categorical features (e.g., "country=USA") into numerical representations for the model to process. </li> <li>Combines these embeddings with other numerical features into a single input vector. </li> </ul> </li> <li> <p><strong>Cross Network</strong></p> <ul> <li>The core of the DCN, designed to efficiently identify interactions between features. </li> <li>For example, it can uncover that users in the USA who like a specific brand are highly likely to click on a particular ad. </li> </ul> </li> <li> <p><strong>Deep Network</strong></p> <ul> <li>A standard neural network component that captures complex, nonlinear patterns in the data. </li> </ul> </li> <li> <p><strong>Combination Layer</strong></p> <ul> <li>Merges the outputs from the cross and deep networks. </li> <li>The combined features are used to predict the likelihood of a user clicking on an ad. </li> </ul> </li> </ol> <h5 id=data-preparation_1>Data Preparation<a class=headerlink href=#data-preparation_1 title="Permanent link">¶</a></h5> <p>The data preparation script is displayed <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/data/prepare_data_v1.py>here</a>.</p> <p>The main goal is to preprocess news and user interaction data across the training, validation, and testing sets.</p> <ul> <li>Inputs: article, behavior, history .parquet files</li> <li>Output: training, validation, testing .csv files</li> </ul> <p><strong>Function</strong></p> <ol> <li> <p>Loading in news articles from the parquet files.</p> </li> <li> <p>Tokenize and map categorical features.</p> </li> <li> <p>Process user interaction history.</p> </li> <li> <p>Create feature mappings for categories, sentiments, and article types.</p> </li> <li> <p>Generate CSV files with processed features.</p> </li> </ol> <h5 id=model-training_1>Model training<a class=headerlink href=#model-training_1 title="Permanent link">¶</a></h5> <p>Train a Deep Cross Network (DCN) model. The model configuration is <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/src/DCN.py>here</a>. </p> <p><strong>Important Parameters</strong></p> <p><em>Model Architecture</em></p> <ul> <li> <p>embedding_dim: Dimensionality of feature embeddings (<em>default: 10</em>). This controls the size of the embedding vectors used to represent categorical features.</p> </li> <li> <p>dnn_hidden_units: Architecture of the fully connected neural network (<em>default: []</em>). This defines the number of layers and the units in each layer. Leave empty to use only the cross network.</p> </li> <li> <p>dnn_activations: Activation function for the dense layers (<em>default: "ReLU"</em>). Determines the non-linear transformation applied to the output of each dense layer.</p> </li> <li> <p>num_cross_layers: Number of cross layers in the CrossNet (<em>default: 3</em>). Controls the depth of the cross feature interactions.</p> </li> <li> <p>net_dropout: Dropout rate applied to the dense layers (<em>default: 0</em>). Helps to prevent overfitting.</p> </li> <li> <p>batch_norm: Whether to apply batch normalization to dense layers (<em>default: False</em>). Useful for stabilizing training.</p> </li> </ul> <p><em>Regularization</em></p> <ul> <li> <p>embedding_regularizer: Regularization applied to the embedding layer. Helps to control overfitting in the embeddings.</p> </li> <li> <p>net_regularizer: Regularization applied to the network layers.</p> </li> </ul> <p><em>Training Dynamics</em></p> <ul> <li>learning_rate: Controls the step size for model optimization (<em>default: 1e-3</em>). Affects how quickly the model converges during training.</li> <li>optimizer: Optimization algorithm used for training (<em>default: as specified in the model initialization</em>).</li> <li>batch_size: Number of samples per training iteration. Determines the computational efficiency and convergence stability.</li> <li>epochs: Total number of training iterations. Defines how many times the model will see the full dataset.</li> </ul> <p>Below is a code snippet of a DCN dataset config that performed the best. </p><div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>dataset_config</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>ebnerd_large_x2</span><span class=p>:</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>        <span class=n>data_root</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>        <span class=n>data_format</span><span class=p>:</span> <span class=n>csv</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>        <span class=n>train_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>train</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>        <span class=n>valid_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>valid</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>        <span class=n>test_data</span><span class=p>:</span> <span class=o>./</span><span class=n>data</span><span class=o>//</span><span class=n>Ebnerd_large_x2</span><span class=o>/</span><span class=n>test</span><span class=o>.</span><span class=n>csv</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>        <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>10</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>        <span class=n>data_block_size</span><span class=p>:</span> <span class=mi>100000</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>        <span class=n>streaming</span><span class=p>:</span> <span class=kc>True</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>        <span class=n>feature_cols</span><span class=p>:</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>meta</span><span class=p>,</span> <span class=n>remap</span><span class=p>:</span> <span class=kc>False</span><span class=p>}</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>read_time</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>trigger_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>device_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>is_sso_user</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>gender</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>postcode</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>age</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>is_subscriber</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>premium</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>ner_clusters</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>topics</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>category</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>subcategory</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>}</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_inviews</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_pageviews</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>total_read_time</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>sentiment_score</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>numeric</span><span class=p>,</span> <span class=n>fill_na</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>sentiment_label</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>subcat1</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id</span><span class=p>}</span>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_cat</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>category</span><span class=p>}</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_subcat1</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>subcat1</span><span class=p>}</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_sentiment</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>sentiment_label</span><span class=p>}</span>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_type</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_type</span><span class=p>}</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>publish_days</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>publish_hours</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_hour</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>impression_weekday</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>pulish_3day</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>pulish_7day</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>}</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id_img</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(article_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/image_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>article_id_text</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>categorical</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(article_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/contrast_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id_img</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(hist_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/image_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id_img</span><span class=p>}</span>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a>            <span class=o>-</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>hist_id_text</span><span class=p>,</span> <span class=n>active</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>type</span><span class=p>:</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>splitter</span><span class=p>:</span> <span class=o>^</span><span class=p>,</span> <span class=n>max_len</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=n>padding</span><span class=p>:</span> <span class=n>pre</span><span class=p>,</span> <span class=n>freeze_emb</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56 href=#__codelineno-5-56></a>               <span class=n>preprocess</span><span class=p>:</span> <span class=s2>"copy_from(hist_id)"</span><span class=p>,</span> <span class=n>pretrain_dim</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span> <span class=n>pretrained_emb</span><span class=p>:</span> <span class=s2>"./data/Ebnerd_large_x1/contrast_emb_dim64.npz"</span><span class=p>,</span> 
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57 href=#__codelineno-5-57></a>               <span class=n>pretrain_usage</span><span class=p>:</span> <span class=s2>"init"</span><span class=p>,</span> <span class=n>min_categr_count</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=n>share_embedding</span><span class=p>:</span> <span class=n>article_id_text</span><span class=p>}</span>     
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58 href=#__codelineno-5-58></a>        <span class=n>label_col</span><span class=p>:</span> <span class=p>{</span><span class=n>name</span><span class=p>:</span> <span class=n>click</span><span class=p>,</span> <span class=n>dtype</span><span class=p>:</span> <span class=nb>float</span><span class=p>}</span>
</span></code></pre></div><p></p> <p>Below is a code snippet of a DCN model config that performed the best. </p><div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>DCN_doubleq</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    <span class=n>batch_norm</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=mi>7168</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>dataset_id</span><span class=p>:</span> <span class=n>Ebnerd_large_data</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=n>debug_mode</span><span class=p>:</span> <span class=n>false</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=n>dnn_activations</span><span class=p>:</span> <span class=n>ReLU</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>dnn_hidden_units</span><span class=p>:</span> <span class=p>[</span><span class=mi>1024</span><span class=p>,</span> <span class=mi>512</span><span class=p>,</span> <span class=mi>256</span><span class=p>]</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>early_stop_patience</span><span class=p>:</span> <span class=mi>2</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=n>embedding_dim</span><span class=p>:</span> <span class=mi>64</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=n>embedding_regularizer</span><span class=p>:</span> <span class=mf>1.0e-05</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=n>epochs</span><span class=p>:</span> <span class=mi>10</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>    <span class=n>eval_steps</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>    <span class=n>feature_config</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>    <span class=n>feature_specs</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>    <span class=n>group_id</span><span class=p>:</span> <span class=n>impression_id</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>    <span class=n>item_info_fields</span><span class=p>:</span> <span class=mi>12</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>    <span class=n>learning_rate</span><span class=p>:</span> <span class=mf>0.0005</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>    <span class=n>loss</span><span class=p>:</span> <span class=n>binary_crossentropy</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>    <span class=n>metrics</span><span class=p>:</span> <span class=p>[</span><span class=n>avgAUC</span><span class=p>,</span> <span class=n>AUC</span><span class=p>,</span> <span class=n>logloss</span><span class=p>]</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>    <span class=n>model</span><span class=p>:</span> <span class=n>DCN</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>    <span class=n>model_root</span><span class=p>:</span> <span class=o>./</span><span class=n>checkpoints</span><span class=o>/</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>    <span class=n>monitor</span><span class=p>:</span> <span class=n>avgAUC</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>    <span class=n>monitor_mode</span><span class=p>:</span> <span class=nb>max</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>    <span class=n>net_dropout</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>    <span class=n>net_regularizer</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>    <span class=n>num_cross_layers</span><span class=p>:</span> <span class=mi>3</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>    <span class=n>num_workers</span><span class=p>:</span> <span class=mi>3</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a>    <span class=n>optimizer</span><span class=p>:</span> <span class=n>adam</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a>    <span class=n>pickle_feature_encoder</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a>    <span class=n>save_best_only</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a>    <span class=n>seed</span><span class=p>:</span> <span class=mi>20242025</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a>    <span class=n>shuffle</span><span class=p>:</span> <span class=n>true</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>    <span class=n>task</span><span class=p>:</span> <span class=n>binary_classification</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a>    <span class=n>use_features</span><span class=p>:</span> <span class=n>null</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a>    <span class=n>verbose</span><span class=p>:</span> <span class=mi>1</span>
</span></code></pre></div><p></p> <h5 id=prediction_1>Prediction<a class=headerlink href=#prediction_1 title="Permanent link">¶</a></h5> <p>The submission script is displayed <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/submit.py>here</a>.</p> <p>The main goal is to make predictions on the testing set.</p> <p><strong>Function</strong></p> <ol> <li>Create a data loader for test data</li> <li>Load test data from CSV</li> <li>Predicts scores for each sample</li> <li>Ranks predictions for each impression </li> <li>Writes results to a predictions.txt file</li> <li>Zip the predictions </li> </ol> <h5 id=procedure_1>Procedure<a class=headerlink href=#procedure_1 title="Permanent link">¶</a></h5> <ol> <li> <p>Prepare the data by preprocessing news and user interaction data. (go to fuxcitr_dir/data directory)</p> <p><code>python prepare_data_v2.py</code></p> </li> <li> <p>Run the following script in the fuxcitr_dir directory to train the model on train and validation sets.</p> <p><code>python run_param_tuner.py --config config/DCN_ebnerd_large_x2_tuner_config_doubleq_02.yaml --gpu 0</code></p> </li> <li> <p>Run the following script in the fuxcitr_dir directory to make predictions on the test set.</p> <p><code>python submit.py --config config/DCN_ebnerd_large_x2_tuner_config_doubleq_01 --expid DCN_ebnerd_large_x2_001_1860e41e --gpu 1</code></p> </li> </ol> <h5 id=results_1>Results<a class=headerlink href=#results_1 title="Permanent link">¶</a></h5> <p>The results of our best-performing run, including detailed metrics, can be found <a href=https://github.com/SulmanK/2024-Recsys-Challenge/blob/main/fuxcitr_dir/exp_results/DCN_ebnerd_large_x2_tuner_config_doubleq_02.csv>here</a>. It outlines the specifications of our best performing model, in which we achieved an ROC-AUC score of 0.6857.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>20241214-205228 [command] python run_expid.py --config config/DCN_ebnerd_large_x2_tuner_config_doubleq_02 --expid DCN_ebnerd_large_x2_001_c76e9991 --gpu 0  [exp_id] DCN_ebnerd_large_x2_001_c76e9991   [dataset_id] ebnerd_large_x2_7ea969aa   [train] N.A.    [val] avgAUC: 0.685714 - MRR: 0.454175 - NDCG(k=5): 0.516215    [test] 
</span></code></pre></div> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">¶</a></h2> <ol> <li> <p><a href=https://www.ijcai.org/Proceedings/2020/482>Hypernews: simultaneous news recommendation and active-time prediction via a double-task deep neural network.</a></p> </li> <li> <p><a href=https://www.jsjkx.com/EN/Y2018/V45/I11A/462>Research on news recommendation methods considering geographical location of news</a></p> </li> <li> <p><a href=https://www.semanticscholar.org/paper/Multi-label-Convolution-Neural-Network-for-News-on-Saravanapriya-Senthilkumar/a6004a33699ced82c61ff2b492f225bdc44444d8>Saravanapriya M, Senthilkumar R, Saktheeswaran J (2022) Multi-label convolution neural network for personalized news recommendation based on social media mining.</a></p> </li> <li> <p><a href=https://arxiv.org/pdf/1904.10367>Contextual Hybrid Session-based News Recommendation with Recurrent Neural Networks</a></p> </li> <li> <p><a href=https://arxiv.org/abs/2106.08934>Personalized News Recommendation: Methods and Challenges</a></p> </li> <li> <p><a href=https://arxiv.org/pdf/2009.05794>BARS-CTR: Open Benchmarking for Click-Through Rate Prediction</a></p> </li> <li> <p><a href=https://arxiv.org/pdf/1706.06978>Deep Interest Network for Click-Through Rate Prediction</a></p> </li> <li> <p><a href=https://arxiv.org/pdf/1708.05123>Deep &amp; Cross Network for Ad Click Predictions</a></p> </li> </ol> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../04/28/RecSys-Overview/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Recommendation Systems: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Recommendation Systems: Overview </div> </div> </a> <a href=../../../../2025/01/08/Reddit%20AI%20Pulse%20%28On-Prem%29/ class="md-footer__link md-footer__link--next" aria-label="Next: From Reddit to Insights: Building an AI-Powered Data Pipeline with Gemini (On-Prem)"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> From Reddit to Insights: Building an AI-Powered Data Pipeline with Gemini (On-Prem) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.linkedin.com/in/sulman-khan target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> <a href=https://github.com/sulmank target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../../../../javascripts/mathjax.js></script> <script src=../../../../../javascripts/analytics.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>